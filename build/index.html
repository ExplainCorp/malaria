<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="Malaria Data Visualization Tool"/>
  <meta property="og:image" content=""/>
  <meta property="og:site_name" content="Malaria Data Visualization Tool"/>
  <meta property="og:description" content="">
  <title>Malaria Data Visualization Tool</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
  <script src="js/tabletop.js"></script>
  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/d3.v3.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/jquery-ui.css">  
  <style type="text/css">
  body { font-family: 'Open Sans', 'Helvetica', 'Arial', sans-serif;font-size:16px;}
  #landing-page { margin-top:50px; }
  #landing-page #landing-header { width:740px;margin:0px auto;text-align: center}
  #landing-page h1 { font-size:40px;color:#22B573;margin-bottom:28px;}
  #landing-page h2 { font-size:16px;color:#777;line-height:28px;}
  #loading_block { display:none;}
  #loading_msg { width: 100%; margin: 25px auto; font-weight: bold; color: #eee; text-align: center; font-size: 125px; letter-spacing: -10px; }
  #loading_msg p { font-size:125px;}
  #param-container { width:840px;margin:100px auto 35px auto;color:#777;}
  #param-container .all-params { margin-top:50px;}
  #param-container .all-params p { padding-right:15px;}
  #param-container .param-title { width:200px;float:left;text-align: right}
  #param-container .sliders { width:380px;float:left;}
  #param-container .value-ranges { width:120px;float:left;color:#22B573;}
  #param-container .value-ranges p { padding-left:20px;}
  #param-container .param-year { width:120px;float:left;}
  #param-title-text { text-align:center}
  .clear { clear:both;}
  .ui-selectmenu-button span.ui-selectmenu-text { padding:0px;line-height:15px;font-size:10px;}
  #country-container { width:300px;height:20px;margin:28px auto 0px auto;}
  #country-output-container { float:right;position:relative;right:50%;text-align:left;margin-top:10px;height:35px;}
  #country-output { position:relative;left:50%;margin-top:35px; }
  .countries-output { padding:15px 20px;background:#f7f7f7;font-size:18px;color:#555;margin-left:10px;float:left;position:relative;cursor:pointer;}
  .countries-output:hover { color:#222;background:#ddd;}
  .countries-output:first-child { margin-left:0px;}
  .countries-output .closer { position:absolute;top:-5px;right:-1px;width:6px;height:6px;color:#888;font-size:12px; }
  select[disabled] { color:#f7f7f7; }
  .dash-class { color:#ccc;}
  #landing-submit { padding:15px;font-size:18px;font-weight:bold;color:#555;border:1px solid silver;width:200px;text-align: center;margin:0px auto;cursor:pointer;}
  #no_results { display:none;padding:15px;font-size:18px;font-weight:bold;color:#fff;width:200px;text-align: center;margin:0px auto;background-color: #f00000}
  #landing-submit:hover { color:white;background-color:#22B573;}
  #landing-footer { width:200px;text-align:center;font-size:16px;line-height:22px;margin:50px auto;color:#777;}
  #landing-results-output-test { width:400px;font-size:18px;color:#555;text-align:center;margin:20px auto;}
  /** overwrite ui css **/
  #landing-page .ui-corner-all, .ui-corner-bottom, .ui-corner-right, .ui-corner-br { border-radius:0px;}
  #landing-page .ui-slider .ui-slider-handle {width:20px;height:20px;border-radius:50%;border:3px solid #22B573;}
  #landing-page .ui-slider { border:none;border-top:1px solid silver;margin-top:8px;}
  #landing-page .ui-slider-handle { margin-top:-8px;cursor:pointer;}
  #landing-page .ui-slider-range { background:#22B573;height:3px;margin-top:-2px;}
  #landing-page .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default { background:white;}
  #country-container .overflow { height:300px !important;overflow: auto !important}
  #landing-page .ui-state-active { border:0px solid #22B573;}
  #landing-page .ui-selectmenu-button { padding:10px;}
  #param-container .ui-selectmenu-button { margin-top:-10px;}
  #country-container .ui-selectmenu-text { font-size:18px;}
  #country-container .ui-selectmenu-button { width:300px !important;}
  #country-container .ui-selectmenu-button span.ui-selectmenu-text { line-height:25px;}
  /** results viz **/
  #results-viz { width:1205px;margin:50px auto 50px auto;background:white; display: none}
  #results-viz a { text-decoration: none;}
  #results-viz h2 a { color:#22b573;font-size:35px;font-weight:bold;letter-spacing:-2px;}
  #results-viz .results-header-countries { margin-top:15px;}
  #results-viz h3 { font-size:35px;color:#4d4d4d;letter-spacing:-2px;}
  /** nav risks **/
  #results-nav-risks { margin:25px 0px 35px 0px;background:white;}
  #results-viz #nav-risks li { float:left;padding:15px 0px 15px 15px;color:#444;margin-left:1px;cursor:pointer;font-size:15px;width:224px;margin-top:1px;text-transform: uppercase;}
  #results-viz #nav-risks li:hover { background:#222 !important;color:white;}
  #results-viz #nav-risks li:first-child, #results-viz #nav-risks li:nth-child(6) { margin-left:0px;}
  #results-viz #nav-risks .risks-active { color: black;font-weight:bold;}
  #results-viz #nav-risks #risks-population_RISK_FACTOR {background:rgba(166,206,227,.20);border-left:1px solid #444;border-right:1px solid #444;}
  #results-viz #nav-risks #risks-pop_at_risk_RISK_FACTOR {background:rgba(166,206,227,.20);border-left:1px solid #444;border-right:1px solid #444;border-bottom: 1px solid #444}
  #results-viz #nav-risks #risks-GDP_per_capita_RISK_FACTOR {background:rgba(178,223,138,.15);border-right:1px solid #444;}
  #results-viz #nav-risks #risks-funding_RISK_FACTOR {background:rgba(178,223,138,.15);border-right:1px solid #444;border-bottom: 1px solid #444}
  #results-viz #nav-risks #risks-IRS_RISK_FACTOR {background:rgba(200,200,200,.4);}
  #results-viz #nav-risks #risks-ALL_nets_RISK_FACTOR {background:rgba(200,200,200,.4);}
  #results-viz #nav-risks #risks-insecticide_resistance_RISK_FACTOR {background:rgba(200,200,200,.4);border-right:1px solid #444;}
  #results-viz #nav-risks #risks-ALL_larval_control_RISK_FACTOR {background:rgba(200,200,200,.4);border-bottom:1px solid #444;}  
  #results-viz #nav-risks #risks-drugs_RISK_FACTOR {background:rgba(200,200,200,.4);border-bottom:1px solid #444;}
  #results-viz #nav-risks #risks-drug_resistance_RISK_FACTOR {background:rgba(200,200,200,.4);border-bottom:1px solid #444;border-right:1px solid #444;}
  /** nav left **/
  #results-viz #results-nav-left { width:250px;background:white;float:left;}
  #results-viz #results-nav-left p { font-size:15px;font-weight:bold;color:#4d4d4d;padding:15px 5px 15px 15px}
  #results-viz #nav-left {color:#666666;}
  #results-viz #nav-left { height:513px;overflow-y:auto;overflow-x:hidden;}
#results-viz #nav-left::-webkit-scrollbar {
    width: 10px;
}
#results-viz #nav-left::-webkit-scrollbar-track {
    background-color: #f9f9f9;
    border-left: 0px solid #ccc;
}
#results-viz #nav-left::-webkit-scrollbar-thumb {
    background-color: #ccc;
}
#results-viz #nav-left::-webkit-scrollbar-thumb:hover {
  background-color: #aaa;
}

  #results-viz #nav-left li { font-size:13px;padding:15px;margin-right:10px;cursor:pointer;position:relative;}
  #results-viz #nav-left li:hover { background:black;color:white;border-radius:5px;}
  #results-viz #results-content { float:left;width:955px;background:white;margin-bottom:30px;position:relative;}
  #results-viz .results-content-risk { background:white;margin-bottom:15px;position: relative;margin-left:15px;margin-right:35px;}
  #results-viz .results-content-risk .results-risks-title { position:absolute;top:15px;left:5px;font-size:16px;color:#777;}
  #results-viz .results-content-risk:first-child { margin-top:0px;height:600px;}
  #results-viz #nav-left .nav-left-active {   background:rgb(255,127,0);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-a { background:rgb(255,127,0);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-b { background:rgb(31,120,180);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-c { background:rgb(227, 26, 28);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-d { background:rgb(106, 61, 154);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-e { background:rgb(251, 154, 153);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-a:hover { background:rgb(255,127,0);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-b:hover { background:rgb(31,120,180);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-c:hover { background:rgb(227, 26, 28);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-d:hover { background:rgb(106, 61, 154);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-active-e:hover { background:rgb(251, 154, 153);color:white;border-radius:5px;}
  #results-viz #nav-left .nav-left-close { background:#ccc; position:absolute;top:-7px;right:0px;font-size:10px;padding:5px;color:#444;border-radius:25%;display:none;}
  #results-viz #nav-left .nav-left-active:hover > .nav-left-close { background:#222; color:#ccc; }
  #results-viz #index { margin-top:60px;margin-left:255px;font-size:35px;letter-spacing: -1px}
  #results-viz #index a { color:#999;text-decoration:none;padding:10px;border-radius:5px;}
  #results-viz #index a:hover { background:#22b573;color:white;text-decoration:none;}
  #results-viz #footer { padding:10px;font-size:14px;line-height:22px;margin:50px 0px 0px 255px;color:#777; }
  /** d3 stuff **/
  #results-viz #viz_population_RISK_FACTOR .background-class {fill:rgba(166,206,227,.10);}
  #results-viz #viz_pop_at_risk_RISK_FACTOR .background-class {fill:rgba(166,206,227,.10);}
  #results-viz #viz_GDP_per_capita_RISK_FACTOR .background-class {fill:rgba(178,223,138, .15)  ;}
  #results-viz #viz_funding_RISK_FACTOR .background-class {fill:rgba(178,223,138,.15) ;}
  #results-viz #viz_IRS_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}
  #results-viz #viz_ALL_nets_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}
  #results-viz #viz_insecticide_resistance_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}
  #results-viz #viz_ALL_larval_control_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}  
  #results-viz #viz_drugs_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}
  #results-viz #viz_drug_resistance_RISK_FACTOR .background-class {fill:rgba(200,200,200,0.4);}    
  .lines { stroke:#999;fill:none;stroke-width:3px;pointer-events:none;}
  .lines-a { stroke:rgb(255,127,0);fill:none;stroke-width:3px;}
  .lines-b { stroke:rgb(31,120,180);fill:none;stroke-width:3px;}
  .lines-c { stroke:rgb(227, 26, 28);fill:none;stroke-width:3px;}
  .lines-d { stroke:rgb(106, 61, 154);fill:none;stroke-width:3px;}
  .lines-e { stroke:rgb(251, 154, 153);fill:none;stroke-width:3px;}  
  .axis path, .axis line { fill: none; stroke: #ccc; stroke-width: 1px; shape-rendering: crispEdges; } 
  .tick line { stroke:#ccc;stroke-dasharray: 2, 5;}
  .tick:first-child line { display:none;}
  .axis .tick text { font-size:12px;fill:#666;}
  .axis .tick:first-child text { text-anchor:start !important;}
  .x .tick text { text-anchor:end !important;font-size:16px;}
  .y .domain { display:none;}
  .viz-risks { margin-left:25px;}
  /** cases death **/
  #results-viz #cases-deaths { width:1205px;height:500px;display: none}
  #results-viz #cd-results-content { float:left;width:955px;background:white;position:relative;}
  #results-viz #cd-nav-left { width:250px;background:white;float:left;}
  #results-viz #cd-nav-left p { font-size:17px;font-weight:bold;color:#4d4d4d;padding:15px 5px 15px 15px}
  #results-viz #cd-nav-left {color:#666666;}
  #results-viz #cd-nav-left li { font-size:13px;padding:15px;cursor:pointer;}
  #results-viz #cd-nav-left li:hover { background:black;color:white;border-radius:5px;}
  #results-viz #viz_CD { margin-left:15px;margin-right:35px;position: relative; }
  #results-viz #cd-nav-left .cd-nav-left-active { background:black;color:white;border-radius:5px;}
  #results-viz .cd-text-cases, #results-viz .cd-text-deaths { font-size:12px;color:#777;}
  #results-viz .cd-results-risks-title { position:absolute;top:15px;left:20px;font-size:16px;color:#777;}
  #results-viz .voronoi path { fill: none; pointer-events: all; }
  #results-viz .line--hover { stroke:black !important;opacity:1 !important;}
  .voronoi path { cursor:pointer;}
  .focus { pointer-events:none; }
  /** tooltip **/
  .results-content-risk { position:relative;}
  .tt { margin-left:-100px;margin-top:-75px;position:absolute;z-index:999;pointer-events:none;width:200px;}
  .tt #tipContainer { background:#1a1a1a;padding:0px 10px;font-size:20px;text-align:center;border-radius:5px;}
  .tt #tipDate { color:#777;font-size:14px;padding-top:15px;}
  .tt #tipLocation {  color:white;padding-top:5px;}
  .tt #tipData { color:#ddd;margin-top:7px;padding-bottom:15px; }

  </style>
  <script>
  $(document).ready(function() {
      // ** global variables **
      var params = {};
      var country_list = []; 
      var datarisk;
      var datariskCD;
      // ** global d3 variables
      var w,h,hCD,p;
      var viz, viz_int, vizCD;
        // create concentrated dataset for lines by removing params
      var labelVar = 'year';
      var param1 = 'intervention_index_PARAM';
      var param2 = 'development_index_PARAM';
      var param3 = 'vector_behavior_index_PARAM';
      var param4 = 'climate_index_PARAM';
      var param5 = 'transmission_index_PARAM';
      var risk1 = 'population_RISK_FACTOR';
      var risk2 = 'pop_at_risk_RISK_FACTOR';
      var risk3 = 'GDP_per_capita_RISK_FACTOR';
      var risk4 = 'funding_RISK_FACTOR';
      var risk5 = 'ALL_larval_control_RISK_FACTOR';
      var risk6 = 'ALL_nets_RISK_FACTOR';
      var risk7 = 'IRS_RISK_FACTOR';
      var risk8 = 'drugs_RISK_FACTOR';
      var risk9 = 'insecticide_resistance_RISK_FACTOR';
      var risk10 = 'drug_resistance_RISK_FACTOR';
      var mc = 'malaria_cases';
      var md = 'malaria_deaths';
      var viz_population_RISK_FACTOR;
      var viz_pop_at_risk_RISK_FACTOR;
      var viz_funding_RISK_FACTOR;
      var viz_GDP_per_capita_RISK_FACTOR;
      var viz_ALL_larval_control_RISK_FACTOR;
      var viz_ALL_nets_RISK_FACTOR;
      var viz_IRS_RISK_FACTOR;
      var viz_drugs_RISK_FACTOR;
      var viz_insecticide_resistance_RISK_FACTOR;
      var viz_drug_resistance_RISK_FACTOR;
      var format_date;
      var xpos;
      var ypos;
      var minDate, maxDate;
      var xAxis, yAxis;
      var seriesDataCD;
      var all_axis, all_axisCD;
      var varNames, varNamesCD;
      var vData = [];
      var vData_population = [];
      var vData_pop_at_risk = [];
      var vData_funding = [];
      var vData_GDP_per_capita = [];
      var vData_ALL_larval_control = [];
      var vData_ALL_nets = [];
      var vData_IRS = [];
      var vData_drugs = [];
      var vData_insecticide_resistance = [];
      var vData_drug_resistance = [];
      var voronoi = false;
      var voronoiCD = false;
      var cd_cntrys_all = [];
      var v_cd = [];
      var initNavCD = false;
      var getCDid = "Cases";
      var tooltip;
      var exit_idx = null;
      var exit_idxx = null;
      var navArrayIdx = ["a"];
      var colorObj = {};
      var orderObj = {};
      var checker = false;
      var _datarisk = {};
      var _datariskCD = {};

      // ** pull data from spreadsheet into json via tabletop.js
      var public_spreadsheet_url_1 = 'https://docs.google.com/spreadsheets/d/1g5wCiT3hak0H-QfUPfaj3JyNnw4pgwYeRt-mbM3nZKE/pubhtml';
      var public_spreadsheet_url_2 = 'https://docs.google.com/spreadsheets/d/1rozIt4e_U6ofno0Mpg7LRDzeDxBDSowaBDuJeRQV9Ek/pubhtml';
      var public_spreadsheet_url_3 = 'https://docs.google.com/spreadsheets/d/1_J4OHi9RgzaTJN2JbpXhzt00BhalDUIfARudv5qEfd0/pubhtml';
      var public_spreadsheet_url_4 = 'https://docs.google.com/spreadsheets/d/15liN0vN_TDDtOHBhvQvQ5WMYm3yblP7RhVI79w5OTSw/pubhtml';
      var public_spreadsheet_url_5 = 'https://docs.google.com/spreadsheets/d/11vbj91ODayH32PciVe1FOX0AIH-GkOEYetGBhvQ6y-I/pubhtml';
      var public_spreadsheet_url_6 = 'https://docs.google.com/spreadsheets/d/1hPTJKkEHA6k2mlTtnix6Ww2zy_EERo4vZUVN5Agf37Y/pubhtml';
      var public_spreadsheet_url_7 = 'https://docs.google.com/spreadsheets/d/1YMGMrdh-OALDjKBAVlTNoueb1SwbB3UqENzPITV8Cw4/pubhtml';
      var public_spreadsheet_url_8 = 'https://docs.google.com/spreadsheets/d/1GaOqzb2Jtc4mgITgDm5UcI8hjqeJSKWer1DqmxUMtEY/pubhtml';
      var public_spreadsheet_url_9 = 'https://docs.google.com/spreadsheets/d/1gpqp8_6F3B__3BNFtFRCm3jFCbMJBXLl5oPIVbisnaY/pubhtml';
      var public_spreadsheet_url_10 = 'https://docs.google.com/spreadsheets/d/1awzG3UqpLverE6MH6PKwxuVXBE3SllsVX_ZCynj7Hv0/pubhtml';
      var public_spreadsheet_url_11 = 'https://docs.google.com/spreadsheets/d/1EGAxXTn5evnP026-7rE1r5Z-HPFs3X8kSB9qOEb0sB4/pubhtml';
      var public_spreadsheet_url_12 = 'https://docs.google.com/spreadsheets/d/1Ahf9SDttIVKd7iXYjSGVZc4wfkE4JHOa6n8emx3JkTs/pubhtml';
      var public_spreadsheet_url_13 = 'https://docs.google.com/spreadsheets/d/1CLt4Lqpfpns-CLZKNtA5UFtawtVYpUZ6oUak1DPLzoQ/pubhtml';
      var public_spreadsheet_url_14 = 'https://docs.google.com/spreadsheets/d/1cN_vWot03UDAenGs9VNo06KHK1b0Xb4pbld_tBMAVww/pubhtml';

      function init() {
        a = Tabletop({
            key: public_spreadsheet_url_1,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });

        b = Tabletop({
            key: public_spreadsheet_url_2,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        c = Tabletop({
            key: public_spreadsheet_url_3,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });

        d = Tabletop({
            key: public_spreadsheet_url_4,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        }); 

        e = Tabletop({
            key: public_spreadsheet_url_5,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });

        f = Tabletop({
            key: public_spreadsheet_url_6,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        
        g = Tabletop({
            key: public_spreadsheet_url_7,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        
        h = Tabletop({
            key: public_spreadsheet_url_8,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        i = Tabletop({
            key: public_spreadsheet_url_9,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });    
        j = Tabletop({
            key: public_spreadsheet_url_10,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });   

        k = Tabletop({
            key: public_spreadsheet_url_11,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        
        l = Tabletop({
            key: public_spreadsheet_url_12,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });
        m = Tabletop({
            key: public_spreadsheet_url_13,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });    
        n = Tabletop({
            key: public_spreadsheet_url_14,
            callback: showInfo,
            simpleSheet: false,
            parseNumbers: false
        });   
                
      }  
      //init();
      
      function initTabletop() {
        Tabletop.init( { key: public_spreadsheet_url,
                         callback: showInfo,
                         //proxy: 'http://localhost:8080/cache/',
                         simpleSheet: false,
                         parseNumbers: false } )
      }

      cx = 0;

      var sheet_1 = 0;
      var sheet_2 = 0;
      var sheet_3 = 0;
      var sheet_4 = 0;
      var sheet_5 = 0;
      var sheet_6 = 0;
      var sheet_7 = 0;
      var sheet_8 = 0;
      var sheet_9 = 0;
      var sheet_10 = 0;
      var sheet_11 = 0;
      var sheet_12 = 0;
      var sheet_13 = 0;
      var sheet_14 = 0;

      function showInfo(data, tabletop) {
        console.log("Successfully processed sheet: "+(cx+1));
        if (cx == 0) { sheet_1 = data; $(".data_progress").html("1"); }
        if (cx == 1) { sheet_2 = data; $(".data_progress").html("2"); }
        if (cx == 2) { sheet_3 = data; $(".data_progress").html("3"); }
        if (cx == 3) { sheet_4 = data; $(".data_progress").html("4"); }
        if (cx == 4) { sheet_5 = data; $(".data_progress").html("5"); }
        if (cx == 5) { sheet_6 = data; $(".data_progress").html("6"); }
        if (cx == 6) { sheet_7 = data; $(".data_progress").html("7"); }
        if (cx == 7) { sheet_8 = data; $(".data_progress").html("8"); }
        if (cx == 8) { sheet_9 = data; $(".data_progress").html("9"); }
        if (cx == 9) { sheet_10 = data; $(".data_progress").html("10"); }
        if (cx == 10) { sheet_11 = data; $(".data_progress").html("11"); }
        if (cx == 11) { sheet_12 = data; $(".data_progress").html("12"); }
        if (cx == 12) { sheet_13 = data; $(".data_progress").html("13"); }
        if (cx == 13) { sheet_14 = data; $(".data_progress").html("14"); }     
        // temporary, comment this out when landing-page is visible
        //visualize(datarisk);
        if (cx==13) mergeSheets();
        cx++;

      }      

      function mergeSheets() {
        datarisk = {};
        datariskCD = {};
        $.extend(datarisk, sheet_1, sheet_2, sheet_3, sheet_4, sheet_5, sheet_6, sheet_7, sheet_8, sheet_9, sheet_10, sheet_11, sheet_12, sheet_13, sheet_14);

        // cases and deaths
        datariskCD = datarisk;
        
        // store full data in backup objects for additional searches
        _datarisk = datarisk;
        _datariskCD = datarisk;

        $("#loading_msg").hide();
        $("#loading_block").fadeIn();
        //console.log(datarisk)

      }

      // ** init param object and country list 
      function initParams() {
          for (i = 1; i <= 5; i++) {
              params["param" + i + "a"] = 0;
              params["param" + i + "b"] = 100;
              params["param" + i + "year"] = "yearsAll";
          }
        initSliders();
        initCountries();
        init();
        //initTabletop();
      }

      // ** sliders
      function initSliders() {
        $(".sliders").each(function(n) {
            $(this).slider({
                range: true,
                min: 0,
                max: 100,
                values: [0,100],
                slide: function(event, ui) {
                    $(".value-ranges p").eq(n).html(ui.values[0] + " <span class='dash-class'>&mdash;</span> " + ui.values[1]);
                    params["param" + (n + 1) + "a"] = ui.values[0];
                    params["param" + (n + 1) + "b"] = ui.values[1];
                    //console.log(params)
                }
            });
        });
        $(".param-year").each(function(n) {
          $(this).selectmenu({
            change: function(event,data) {
              params["param" + (n + 1) + "year"] = data.item.value;
              //console.log(params)
            }
          })
        })
      }

      // ** country drop down [done]
      // to do: if all countries -> deselect drop down [done]
      // to do: if something other than all countries -> deselect all countries [done]
      function initCountries() {
        $("#countries").selectmenu({
          change: function(event,data) {
            ctry = data.item.value;
            ctry_txt = data.item.label;
            country_list.push(ctry);
            $("#countries option[value="+ctry+"]").attr('disabled',true);
            $("#country-output").append("<div class='countries-output' id='"+ctry+"'>"+ctry_txt+"<div class='closer'>&#10006;</div>");
            if (country_list.length >= 1 && ctry!="All_Countries") {
              $("#countries option[value='All_Countries']").attr('disabled',true);
            }
            disableDD();
            checkCountryLength();
            $(this).selectmenu("refresh");            
          }
        })
        $("#country-output").on("click", ".countries-output", function(e) {
          ctry="";
          e.preventDefault();
          get_ctry = $(this).attr("id");
          index = country_list.indexOf(get_ctry);
          if (index > -1) {
            country_list.splice(index, 1);
          }
          checkCountryLength();
          $(this).remove();
          if (country_list.length < 1) {
            $("#countries option[value='All_Countries']").attr('disabled',false);
          }
          $("#countries option[value=" + get_ctry + "]").attr('disabled',false);
          $("#countries").selectmenu("refresh");
          checkCountryLength();
        })          
      }

      // ** max 5 countries drop down
      function checkCountryLength() {
        if (country_list.length == 5 || ctry=="All_Countries") {
          console.log("disabled")
          $("#countries").selectmenu().selectmenu("disable");  
        } else {
          $("#countries").selectmenu().selectmenu("enable");
          console.log("enabled")   
        }        
      }

      // disable if All Countries selected
      function disableDD() {
        if (ctry=="All_Countries") {
          console.log("all_countries-selected")
          $("#countries").selectmenu().selectmenu("disable");  
          $("#param-container").fadeIn();
          $("#landing-submit").css({"margin-top":"0px"})
        } else {
          $("#countries").selectmenu().selectmenu("enable"); 
          $("#param-container").fadeOut();
          $("#landing-submit").css({"margin-top":"80px"})
        }
      }

      initParams();

      // to do: submit button has to check values are inputted
      // submit button goes here
      // keep submit disabled until a selection has been changed?

      $("#landing-submit").on("click", function(e) {
        e.preventDefault();
        var param1_start, param1_end = 0;
        var param2_start, param2_end = 0;
        var param3_start, param3_end = 0;
        var param4_start, param4_end = 0;
        var param5_start, param5_end = 0;

        var param1check = false;
        var param2check = false;
        var param3check = false;
        var param4check = false;
        var param5check = false;
        var datariskFiltered;

        // param1 = transmission_index_PARAM
        // param2 = climate_index_PARAM
        // param3 = vector_behavior_index_PARAM
        // param4 = development_index_PARAM
        // param5 = intervention_index_PARAM

        // reset
        datarisk = _datarisk;
        datariskCD = _datariskCD;

        if (country_list.length == 0) {
            // match drop downs with location in spreadsheets
            if (params["param1year"]=="years1898to1910") {
              param1_start = 0; param1_end = 12;
            } else if (params["param1year"]=="years1911to1920") {
              param1_start = 13; param1_end = 22;
            } else if (params["param1year"]=="years1921to1930") {
              param1_start = 23; param1_end = 32;
            } else if (params["param1year"]=="years1931to1940") {
              param1_start = 33; param1_end = 42;
            } else if (params["param1year"]=="years1941to1950") {
              param1_start = 43; param1_end = 52;
            } else if (params["param1year"]=="years1951to1960") {
              param1_start = 53; param1_end = 62;
            } else if (params["param1year"]=="years1961to1970") {
              param1_start = 63; param1_end = 72;
            } else if (params["param1year"]=="years1971to1980") {
              param1_start = 73; param1_end = 82;
            } else if (params["param1year"]=="years1981to1990") {
              param1_start = 83; param1_end = 92;
            } else if (params["param1year"]=="years1991to2000") {
              param1_start = 93; param1_end = 102;
            } else if (params["param1year"]=="years2001to2005") {
              param1_start = 103; param1_end = 107;
            } else if (params["param1year"]=="years2006to2010") {
              param1_start = 108; param1_end = 112;
            } else if (params["param1year"]=="years2011to2015") {
              param1_start = 113; param1_end = 116;
            } else {
              param1_start = 0; param1_end = datarisk["Africa-Algeria"].elements.length;
            }

            if (params["param2year"]=="years1898to1910") {
              param2_start = 0; param2_end = 12;
            } else if (params["param2year"]=="years1911to1920") {
              param2_start = 13; param2_end = 22;
            } else if (params["param2year"]=="years1921to1930") {
              param2_start = 23; param2_end = 32;
            } else if (params["param2year"]=="years1931to1940") {
              param2_start = 33; param2_end = 42;
            } else if (params["param2year"]=="years1941to1950") {
              param2_start = 43; param2_end = 52;
            } else if (params["param2year"]=="years1951to1960") {
              param2_start = 53; param2_end = 62;
            } else if (params["param2year"]=="years1961to1970") {
              param2_start = 63; param2_end = 72;
            } else if (params["param2year"]=="years1971to1980") {
              param2_start = 73; param2_end = 82;
            } else if (params["param2year"]=="years1981to1990") {
              param2_start = 83; param2_end = 92;
            } else if (params["param2year"]=="years1991to2000") {
              param2_start = 93; param2_end = 102;
            } else if (params["param2year"]=="years2001to2005") {
              param2_start = 103; param2_end = 107;
            } else if (params["param2year"]=="years2006to2010") {
              param2_start = 108; param2_end = 112;
            } else if (params["param2year"]=="years2011to2015") {
              param2_start = 113; param2_end = 116;
            } else {
              param2_start = 0; param2_end = datarisk["Africa-Algeria"].elements.length;
            }

            if (params["param3year"]=="years1898to1910") {
              param3_start = 0; param3_end = 12;
            } else if (params["param3year"]=="years1911to1920") {
              param3_start = 13; param3_end = 22;
            } else if (params["param3year"]=="years1921to1930") {
              param3_start = 23; param3_end = 32;
            } else if (params["param3year"]=="years1931to1940") {
              param3_start = 33; param3_end = 42;
            } else if (params["param3year"]=="years1941to1950") {
              param3_start = 43; param3_end = 52;
            } else if (params["param3year"]=="years1951to1960") {
              param3_start = 53; param3_end = 62;
            } else if (params["param3year"]=="years1961to1970") {
              param3_start = 63; param3_end = 72;
            } else if (params["param3year"]=="years1971to1980") {
              param3_start = 73; param3_end = 82;
            } else if (params["param3year"]=="years1981to1990") {
              param3_start = 83; param3_end = 92;
            } else if (params["param3year"]=="years1991to2000") {
              param3_start = 93; param3_end = 102;
            } else if (params["param3year"]=="years2001to2005") {
              param3_start = 103; param3_end = 107;
            } else if (params["param3year"]=="years2006to2010") {
              param3_start = 108; param3_end = 112;
            } else if (params["param3year"]=="years2011to2015") {
              param3_start = 113; param3_end = 116;
            } else {
              param3_start = 0; param3_end = datarisk["Africa-Algeria"].elements.length;
            }

            if (params["param4year"]=="years1898to1910") {
              param4_start = 0; param4_end = 12;
            } else if (params["param4year"]=="years1911to1920") {
              param4_start = 13; param4_end = 22;
            } else if (params["param4year"]=="years1921to1930") {
              param4_start = 23; param4_end = 32;
            } else if (params["param4year"]=="years1931to1940") {
              param4_start = 33; param4_end = 42;
            } else if (params["param4year"]=="years1941to1950") {
              param4_start = 43; param4_end = 52;
            } else if (params["param4year"]=="years1951to1960") {
              param4_start = 53; param4_end = 62;
            } else if (params["param4year"]=="years1961to1970") {
              param4_start = 63; param4_end = 72;
            } else if (params["param4year"]=="years1971to1980") {
              param4_start = 73; param4_end = 82;
            } else if (params["param4year"]=="years1981to1990") {
              param4_start = 83; param4_end = 92;
            } else if (params["param4year"]=="years1991to2000") {
              param4_start = 93; param4_end = 102;
            } else if (params["param4year"]=="years2001to2005") {
              param4_start = 103; param4_end = 107;
            } else if (params["param4year"]=="years2006to2010") {
              param4_start = 108; param4_end = 112;
            } else if (params["param4year"]=="years2011to2015") {
              param4_start = 113; param4_end = 116;
            } else {
              param4_start = 0; param4_end = datarisk["Africa-Algeria"].elements.length;
            }   

            if (params["param5year"]=="years1898to1910") {
              param5_start = 0; param5_end = 12;
            } else if (params["param5year"]=="years1911to1920") {
              param5_start = 13; param5_end = 22;
            } else if (params["param5year"]=="years1921to1930") {
              param5_start = 23; param5_end = 32;
            } else if (params["param5year"]=="years1931to1940") {
              param5_start = 33; param5_end = 42;
            } else if (params["param5year"]=="years1941to1950") {
              param5_start = 43; param5_end = 52;
            } else if (params["param5year"]=="years1951to1960") {
              param5_start = 53; param5_end = 62;
            } else if (params["param5year"]=="years1961to1970") {
              param5_start = 63; param5_end = 72;
            } else if (params["param5year"]=="years1971to1980") {
              param5_start = 73; param5_end = 82;
            } else if (params["param5year"]=="years1981to1990") {
              param5_start = 83; param5_end = 92;
            } else if (params["param5year"]=="years1991to2000") {
              param5_start = 93; param5_end = 102;
            } else if (params["param5year"]=="years2001to2005") {
              param5_start = 103; param5_end = 107;
            } else if (params["param5year"]=="years2006to2010") {
              param5_start = 108; param5_end = 112;
            } else if (params["param5year"]=="years2011to2015") {
              param5_start = 113; param5_end = 116;
            } else {
              param5_start = 0; param5_end = datarisk["Africa-Algeria"].elements.length;
            }                     

            console.log(params["param1year"]+" : "+param1_start+" : "+param1_end)
            console.log(params["param2year"]+" : "+param2_start+" : "+param2_end)
            console.log(params["param3year"]+" : "+param3_start+" : "+param3_end)
            console.log(params["param4year"]+" : "+param4_start+" : "+param4_end)
            console.log(params["param5year"]+" : "+param5_start+" : "+param5_end)

            for (i in datarisk) {

                // gotta have separate loop for each drop-down range
                // with respective start_params/end_params
                
                for (q = param1_start; q < param1_end; q++) {
                    if (datarisk[i].elements[q]["transmission_index_PARAM"] >= params["param1a"] && datarisk[i].elements[q]["transmission_index_PARAM"] <= params["param1b"]) {
                        param1check = true;
                    } else {
                        param1check = false;
                        break;
                    }
                    //console.log(datarisk[i].name+" | param1:  "+datarisk[i].elements[q]["transmission_index_PARAM"]+" | "+param1check)                  
                }

                for (q = param2_start; q < param2_end; q++) {

                    if (datarisk[i].elements[q]["climate_index_PARAM"] >= params["param2a"] && datarisk[i].elements[q]["climate_index_PARAM"] <= params["param2b"]) {
                        param2check = true;
                    } else {
                        param2check = false;
                        break;
                    }

                }

                for (q = param3_start; q < param3_end; q++) {

                    //console.log(q+" "+datarisk[i].elements[q]["vector_behavior_index_PARAM"])

                    if (datarisk[i].elements[q]["vector_behavior_index_PARAM"] >= params["param3a"] && datarisk[i].elements[q]["vector_behavior_index_PARAM"] <= params["param3b"]) {
                        param3check = true;
                    } else {
                        param3check = false;
                        break;
                    }
                
                }

                for (q = param4_start; q < param4_end; q++) {

                    if (datarisk[i].elements[q]["development_index_PARAM"] >= params["param4a"] && datarisk[i].elements[q]["development_index_PARAM"] <= params["param4b"]) {
                        param4check = true;
                    } else {
                        param4check = false;
                        break;
                    }
                
                }

                for (q = param1_start; q < param1_end; q++) {

                    if (datarisk[i].elements[q]["intervention_index_PARAM"] >= params["param5a"] && datarisk[i].elements[q]["intervention_index_PARAM"] <= params["param5b"]) {
                        param5check = true;
                    } else {
                        param5check = false;
                        break;
                    }
                
                }

                if (param1check != true || param2check != true || param3check != true || param4check != true || param5check != true) {
                    console.log("filtered out: " + datarisk[i].name)
                    //delete datarisk[i];
                } else {
                    country_list.push(datarisk[i].name)
                }

                param1check = false;
                param2check = false;
                param3check = false;
                param4check = false;
                param5check = false;

            }
            console.log(country_list)
            if (country_list.length>0) {
              visualize(country_list);
            } else {
              $("#landing-submit").hide();
              $("#no_results").fadeIn();
              setTimeout(function(){$('#no_results').hide();}, 2500);
              $("#landing-submit").delay(2550).fadeIn();
              console.log("no results!")
            }
        
          console.log("filtered")
       
        } else  {
          visualize(country_list);
        }
          
      });

      var checkParams = function(_data) {
        for (q in _data.elements) {
          console.log(_data.elements[q]["transmission_index_PARAM"]<6)
        }
      }

      // arrays for selected navigation items
      var risks_all = [];
      var cntrys_all = [];
      // to do: add labels to risk boxes at top left [done]
      $("#results-viz #nav-risks li").on("click", function(e) {
          e.preventDefault();
          $(this).toggleClass("risks-active");
          navEvents();
          if (get_risk_cnt == 0) $(this).addClass("risks-active")
      })

      function navEvents(navActive, country_object, color_obj) {
          // reset arrays on every click
          risks_all.length = 0;
          cntrys_all.length = 0;

          get_risk_cnt = $("#results-viz #nav-risks .risks-active").length;
          get_cnty_cnt = $("#results-viz #nav-left .nav-left-active").length;

          $("#results-viz #nav-risks .risks-active").each(function(i) {
              idx = $(this).index();
              risks = $("#results-viz #nav-risks li").eq(idx).attr("id").split("risks-")[1];
              risks_all.push(risks);
          });
          $("#results-viz #nav-left .nav-left-active").each(function(j) {
              cntrys = $("#results-viz .nav-left-active").eq(j).attr("id");
              cntrys_all.push(cntrys);
          });

          divideSpaces(risks_all, get_risk_cnt, cntrys_all, country_object, color_obj);

          //$(".nav-active-countries").append(cntrys_all.join(", "))
          // color the country headers here by getting color from left nav
          $(".nav-active-countries").html("");
          for (k=0;k<cntrys_all.length;k++) {
            get_nav_color = $("#nav-left #"+cntrys_all[k]).css("background-color")
            if (k==(cntrys_all.length-1)) {
              $(".nav-active-countries").append("<span class='nav-cntry' style='color:"+get_nav_color+"''>"+cntrys_all[k]+"</span>");  
            } else {
            $(".nav-active-countries").append("<span class='nav-cntry' style='color:"+get_nav_color+"''>"+cntrys_all[k]+"</span><span>, </span>");
            }
          }
          // this area is for drawing cases/deaths for selected countries
          $("#results-viz .cd-results-content-risk").html("");
          createSVG_CD(cntrys_all, getCDid);
      } 

      function divideSpaces(risks, count, countries, country_object, color_obj) {
          $("#results-viz #results-content").html("");

          // set height of first div that divides
          set_height = 600;
          if (count <= 5) {
              risks_height = set_height / count;
          } else {
              risks_height = set_height / 5;
          }

          // get risk count and create separate svgs
          for (i = 0; i < count; i++) {
              get_title = $("#results-viz #nav-risks li#risks-" + risks_all[i]).text();

              $("#results-viz #results-content").append("<div id='" + risks_all[i] + "' class='results-content-risk' style='height:" + risks_height + "px'><div class='results-risks-title'>" + get_title + "</div></div>")
              createSVG(risks_all[i], risks_height, count, i);
              // create tooltips
              createTT(risks_all[i]);
              console.log("...svg created")
          }

          vData = [];
          vData_mult = [];
          vData_population = [];
          vData_pop_at_risk = [];
          vData_funding = [];
          vData_GDP_per_capita = [];
          vData_ALL_larval_control = [];
          vData_ALL_nets = [];
          vData_IRS = [];
          vData_drugs = [];
          vData_insecticide_resistance = [];
          vData_drug_resistance = [];
          voronoi = false;
          checker = false;

          // call risks viz function here
          for (j = 0; j < countries.length; j++) {
              voronoi = false;
              if ((j + 1) == countries.length) {
                  voronoi = true;
              }
              for (k = 0; k < risks_all.length; k++) {
                  graph_risks(datarisk[countries[j]].elements, risks_all[k], risks_height, countries[j], count, k, voronoi, j,runColorCheck(colorObj,countries[j]))
                    //console.log(colorObj[j])
                    //console.log(navArrayIdx)
              }
          }
      }
    
      // this gets the key of the value [[fixed]]
      var getKeyByValue = function( obj, value ) {
          for( var prop in obj ) {
              if( obj.hasOwnProperty( prop ) ) {
                   if( obj[ prop ] === value )
                       return prop;
              }
          }
      }

      function runColorCheck(colorObj,cntry) {
        return (getKeyByValue(colorObj, cntry))
      }

      // draw left-nav based off country_list or param filters w/ All Countries
      // first draw it off of country_list [done]
      // after draw it off of all_countries + params
      function drawNav(countries) {
        console.log("...drawNav")
        //console.log(countries.length)
        $("#results-viz #nav-left").html("");
        for (i=0;i<countries.length;i++) {
          $("#results-viz #nav-left").append("<li id="+countries[i]+">"+countries[i]+"</li>") 
          /*
          $("#results-viz #nav-left").append("<li id="+countries[i]+">"+countries[i]+"<span class='nav-left-close'>&#10006;</span></li>")
          */
        }

        $("#results-nav-left #nav-left li").eq(0).addClass("nav-left-active nav-left-active-a");
        $("#results-nav-left #nav-left li.nav-left-active .nav-left-close").eq(0).show();

        navLeftEvents(countries);
        $("#results-viz #cases-deaths").show();
      }

      function navLeftEvents(countries) {
        console.log("...navLeftEvents")

        // call first graph here
        colorObj.a = countries[0];
        colorObj.b = null;
        colorObj.c = null;
        colorObj.d = null;
        colorObj.e = null;   

        orderObj.a = "a";
        orderObj.b = null;
        orderObj.c = null;
        orderObj.d = null;
        orderObj.e = null;   

        navEvents(countries[0], colorObj); 

        $("#results-nav-left #nav-left li").on("click", function(e) {
          e.preventDefault();
          var colorCheck = false;
          var get_id;

          colorCheck = false;
          get_id = $(this).attr("id");
          //console.log(get_id)
          //navArrayIdx = [];

          for (o in colorObj) {
              if (colorObj[o] == get_id) {
                  colorCheck = true;
              }
          }

          for (o in colorObj) {
              if (colorCheck == false && colorObj[o] == null) {
                  colorObj[o] = get_id;
                  $(this).addClass("nav-left-active nav-left-active-" + o)
                  orderObj[o] = o;
                  break;
              }
              if (colorCheck == true && colorObj[o] == get_id) {
                  colorObj[o] = null;
                  $(this).removeAttr("class")
                  orderObj[o] = null;
              }
          }

          //console.log(colorObj)

          navArrayIdx = [];

          navEvents(get_id, colorObj);
        })        
      }

      function visualize(country_list) {
        // push countries from spreadsheet into nav
        $("#landing-page").hide();
        $("#results-viz").show();

        //_selected_ctrys = selected_ctrys;
        //console.log(country_list)
        //console.log(datarisk)
        //country_list.length = 0;
        //console.log(_selected_ctrys)
        //_i = 0;
        //for (d in _selected_ctrys) {

          // ** PROBLEM IS HERE::NEED TO CHECK! ONE COUNTRY AT A TIME?!

          //console.log(datarisk[d])
          //if (datarisk[d].name!==_selected_ctrys[_i]) {
            //console.log(datarisk[d].name + " " + _selected_ctrys[_i])
            //console.log(_selected_ctrys[d])
            //country_list.push(datarisk[d].name)
          //}
          //_i++;
       // }
        
        // alphabetize
        country_list.sort();
        //console.log(country_list)
        // for testing purposes, some countries here
        //country_list.push("Cambodia","Laos","Myanmar","Thailand","Vietnam","Botswana","Haiti","Namibia","South_Africa","Swaziland");

        drawNav(country_list);
      }

      // for hovers, bring line to front
      d3.selection.prototype.moveToFront = function() {
        return this.each(function(){
          this.parentNode.appendChild(this);
        });
      };   

      function createTT(risk) {
          if (risk === "cd") {
              tooltip = d3.select("#cases-deaths #cd-results-content .cd-results-content-risk")
                  .append("div")
                  .attr("id", "cd_tt")
                  .attr("class", "tt")
                  .style("z-index", "500")
                  .style("position", "absolute")
                  .style("visibility", "hidden");
          } else {
              tooltip = d3.select("#results-content #" + risk)
                  .append("div")
                  .attr("class", "tt tt_" + risk)
                  .style("z-index", "500")
                  .style("position", "absolute")
                  .style("visibility", "hidden");
          }
      }

      // working tooltip
      function tt(type, risk, country, date, value, x, y) {
          if (type == "risks") {
              //d3.selectAll("#results-content .tt").style("visibility", "hidden");
              d3.select("#results-content #" + risk + " .tt_" + risk)
                  .style("visibility", "visible")
                  .style("left", x + "px")
                  .style("top", y - 50 + "px")
                  .html("<div id='tipContainer'><div id='tipDate'>"+date+"</div><div id='tipLocation'>" + country + "</div><div id='tipData'>" + value + "</div></div>");
          }
          if (type == "cd") {
              //d3.select("#cd-results-content .tt").style("visibility", "hidden");
              d3.select("#cd-results-content #cd_tt")
                  .style("visibility", "visible")
                  .style("left", (x + 15) + "px")
                  .style("top", y - 50 + "px")
                  .html("<div id='tipContainer'><div id='tipDate'>"+date+"</div><div id='tipLocation'>" + country + "</div><div id='tipData'>" + value + "</div></div>");
          }
      }


      // risk svg's are separate to avoid duplicates
      function createSVG(riskID, h2, count, idx) {
        p = 25; // padding
        w = 955;
        h = h2;

        if ((idx+1)==count) { 
          h = h2;
        } else {
          h = h2 + p;
        }

        viz = d3.select("#results-content #"+riskID).append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("id", "viz_"+riskID)
          .attr("class", "viz-visks")

        viz.append("rect")
          .attr("width", w-(p*2))
          .attr("height", h-(p+5))
          .attr("y", 5)
          .attr("class", "background-class")
          //.style("fill", "#f2f2f2")

        format_date = d3.time.format("%Y").parse; 

        minDate = new Date("1/1/1898");
        // temporary, pull from sheet
        maxDate = new Date("1/1/2015");

        xpos = d3.time.scale()
          .domain([minDate,maxDate])
          .range([0, w-(p*2)]);

        ypos = d3.scale.linear()
          .domain([0,100])
          .range([h-p,5]);      

        xAxis = d3.svg.axis()
          .scale(xpos)
          .orient("bottom")
          .tickValues([minDate,maxDate])
          .tickFormat(d3.time.format("%Y"))
          .tickSize(0,0)

        if (count == 1) {
          yTicks = ["0","10","20","30","40","50","60","70","80","90","100"];
        } else if (count < 4) {
          yTicks = ["0","50","100"];
        } else {
          yTicks = ["0","100"];
        }

        yAxis = d3.svg.axis()
          .scale(ypos)
          .orient("right")
          .tickValues(yTicks)
          .tickSize(-(w-(p*2)),0)
        

        all_axis = d3.select("#results-content #viz_"+riskID);

        if ((idx+1)==count) {           
          all_axis.append("g")
              .attr("class", "x axis")
              .attr("transform", "translate(0," + (h2-(p)) + ")")
              .call(xAxis)
              .selectAll("text")
              .attr("y", "10px");
        }        
 
        all_axis.append("g")
            .attr("class", "y axis")
            .attr("transform", "translate("+(w-(p*2))+",0)")
            .call(yAxis)
            .selectAll("text")
            .attr("x", "10px")

          modifyLabels();
      }

      // visualize risks
      function graph_risks(data,risksID,h2,country,count, idx, v, cntry_idx, color_idx) {      

        //console.log(color_idx)

        if ((idx+1)==count) { 
          h = h2;
        } else {
          h = h2 + p;
        }

        voronoi = v;

        varNames = d3.keys(data[0]).filter(function (key) { return key != labelVar && key != param1 && key != param2 && key != param3 && key != param4 && key != param5 && key != mc && key != md;});
                                                                    
        // target data
        if (risksID == "population_RISK_FACTOR") getidx = 0;          
        if (risksID == "pop_at_risk_RISK_FACTOR") getidx = 1;
        if (risksID == "GDP_per_capita_RISK_FACTOR") getidx = 2;        
        if (risksID == "funding_RISK_FACTOR") getidx = 3;
        if (risksID == "ALL_larval_control_RISK_FACTOR") getidx = 4;
        if (risksID == "ALL_nets_RISK_FACTOR") getidx = 5;
        if (risksID == "IRS_RISK_FACTOR") getidx = 6;
        if (risksID == "drugs_RISK_FACTOR") getidx = 7;
        if (risksID == "insecticide_resistance_RISK_FACTOR") getidx = 8;
        if (risksID == "drug_resistance_RISK_FACTOR") getidx = 9;

        var seriesData = varNames.map(function (name) {
          return {
            name: name,
            values: data.map(function (d) {
                return {name: name, label: d[labelVar], value: +d[name], country:country};
            })
          };
        });
   
        //console.log(seriesData);
        //return xpos(format_date(d.label));
        //return ypos(d.value);             
        // isolate risk data
        _newdata = seriesData[getidx];

        // remove NA values from data         
        var newdataB = {};

        newdataB = {
            "name": null,
            "values": []
        }

        for (var i in _newdata.values) {
            if (isNaN(_newdata.values[i].value) != true && _newdata.values[i].value != 0) {
              
                newdataB.name = _newdata.values[i].name;
                var _dataFilter = {
                    "label": _newdata.values[i].label,
                    "name": _newdata.values[i].name,
                    "country": _newdata.values[i].country,
                    "value": _newdata.values[i].value
                }
                newdataB.values.push(_dataFilter);
            }
        }

        newdata = newdataB;

        var line = d3.svg.line()
          //.interpolate("monotone")
          .x(function (d) { return xpos(format_date(d.label))  })
          .y(function (d) { return ypos(d.value) })
          //.defined(function(d) { return !isNaN(d.value); })

        var series = d3.select("#results-content #viz_"+risksID)
          .datum(newdata)
          .append("path")
          .attr("class", "lines lines-"+country+" lines-"+color_idx)
          .attr("id", function(d) { return "line-"+country+"-"+d.name })
          .attr("d", function (d) { return line(d.values)  })

        
        var series_text = d3.select("#results-content #viz_"+risksID)
          .datum(newdata)
          .append("text")
          .attr("x", 5)
          .attr("y", function (d) { 
            if (d.values[0].value>=80 && d.values[0].value <= 100)
            {
              return ypos(d.values[0].value)+50 
            } else {
              return ypos(d.values[0].value)-10
            }
          })
          .text(country)
          //.style("display","none")
        
        // format voronoi data
        var voronoi_data = function(input) {
          vData_input = input;
          uniqueData = d3.nest()
            .key(function(d) { return xpos(format_date(d.label)) + "," +ypos(d.value); })
            .rollup(function(v) { return v[0]; })
            .entries(d3.merge(vData_input.map(function(d) { return d.values; })))
            .map(function(d) { return d.values });    
            vData = uniqueData;        
        }
        
        // each risk needs its own data set
        // there must be a better way to do this, but it works, so i'm happy.
        
        if (risksID == "population_RISK_FACTOR") {
          vData_population.push(newdata);
          voronoi_data(vData_population);        
        }
        if (risksID == "pop_at_risk_RISK_FACTOR") {
          vData_pop_at_risk.push(newdata); 
          voronoi_data(vData_pop_at_risk); 
        }
        if (risksID == "funding_RISK_FACTOR") {
          vData_funding.push(newdata);
          voronoi_data(vData_funding);
        }
        if (risksID == "GDP_per_capita_RISK_FACTOR") {
          vData_GDP_per_capita.push(newdata);
          voronoi_data(vData_GDP_per_capita);     
        }
        if (risksID == "ALL_larval_control_RISK_FACTOR") {
          vData_ALL_larval_control.push(newdata);
          voronoi_data(vData_ALL_larval_control);     
        }
        if (risksID == "ALL_nets_RISK_FACTOR") {
          vData_ALL_nets.push(newdata);
          voronoi_data(vData_ALL_nets);     
        }
        if (risksID == "IRS_RISK_FACTOR") {
          vData_IRS.push(newdata);
          voronoi_data(vData_IRS);     
        }
        if (risksID == "drugs_RISK_FACTOR") {
          vData_drugs.push(newdata);
          voronoi_data(vData_drugs);     
        }
        if (risksID == "insecticide_resistance_RISK_FACTOR") {
          vData_insecticide_resistance.push(newdata);
          voronoi_data(vData_insecticide_resistance);     
        }
        if (risksID == "drug_resistance_RISK_FACTOR") {
          vData_drug_resistance.push(newdata);
          voronoi_data(vData_drug_resistance);     
        }

        // this may change, only want to apply to last instance of loop
        if (voronoi==true) {
          var vor = d3.select("#results-content #viz_"+risksID).append("g")
            .attr("id", "paths")
            .attr("class", "voronoi");

          var voronoi = d3.geom.voronoi()
            .x(function (d) { return xpos(format_date(d.label)); })
            .y(function (d) { return ypos(d.value) })
            .clipExtent([[0, 0], [w - (p*2), h - p]]);
      
          var focus = d3.select("#results-content #viz_"+risksID).append("g")
            .attr("transform", "translate(-100,-100)")
            .attr("class", "focus");

          focus.append("circle")
            .attr("r", 5);

          focus.append("text")
            .attr("y", -10);

          vor.selectAll("path")
            .data(voronoi(vData))
            .enter().append("path")
            .style("fill", "none")
            .style("stroke", "white")
            .style("stroke-opacity",0)
            .attr("d", function(d) { return "M" + d.join("L") + "Z"; })
            .datum(function(d) { return d.point })
            .on("mouseover", mouseover)
            .on("mouseout", mouseout);            
        }
      
        function mouseover(d) {
          d3.selectAll("#results-content .lines").style("opacity", "0.25")
          d3.selectAll("#results-content .lines-"+d.country).classed("line--hover", true).moveToFront();
          tt("risks",d.name,d.country,d.label,d.value, xpos(format_date(d.label)), ypos(d.value))
          focus.attr("transform", "translate(" + xpos(format_date(d.label)) + "," + ypos(d.value) + ")");
        }

        function mouseout(d) {
          d3.selectAll("#results-viz .tt").style("visibility", "hidden");
          d3.selectAll("#results-content .lines-"+d.country).classed("line--hover", false);
          d3.selectAll("#results-content .lines").style("opacity", "1")
          focus.attr("transform", "translate(-100,-100)");
        }   

      }

      // create one svg for cases and deaths
      function createSVG_CD(countries, getNav) {
        p = 25; // padding
        w = 955;
        hCD = 500;
        count = 3;

        vizCD = d3.select("#results-viz .cd-results-content-risk").append("svg")
          .attr("width", w)
          .attr("height", hCD)
          .attr("id", "viz_CD");

        vizCD.append("rect")
          .attr("width", w-(p*2))
          .attr("height", hCD-(p+5))
          .attr("y", 5)
          .attr("class", "background-class")
          .style("fill", "#f2f2f2")

        yposCD = d3.scale.linear()
          .domain([0,100])
          .range([hCD-p,5]);   

        xAxis = d3.svg.axis()
            .scale(xpos)
            .orient("bottom")
            .tickValues([minDate,maxDate])
            .tickFormat(d3.time.format("%Y"))
            .tickSize(0,0)

        if (count == 1) {
          yTicks = ["0","10","20","30","40","50","60","70","80","90","100"];
        } else if (count < 4) {
          yTicks = ["0","50","100"];
        } else {
          yTicks = ["0","100"];
        }

        yAxisCD = d3.svg.axis()
            .scale(yposCD)
            .orient("right")
            .tickValues(["0","10","20","30","40","50","60","70","80","90","100"])
            .tickSize(-(w-(p*2)),0)

        all_axisCD = d3.select("#cd-results-content #viz_CD");
        
        all_axisCD.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + (hCD-(p)) + ")")
            .call(xAxis)
            .selectAll("text")
            .attr("y", "10px");
        
        all_axisCD.append("g")
            .attr("class", "y axis")
            .attr("transform", "translate("+(w-(p*2))+",0)")
            .call(yAxisCD)
            .selectAll("text")
            .attr("x", "10px")

          modifyLabelsCD();      

        getCDid = getNav;
       
        voronoiCD = false;
        v_cd = [];
        // draw cases and deaths lines
        for(j=0;j<countries.length;j++) {
          voronoiCD = false;
          if ((j+1)==countries.length) {
            voronoiCD = true;
          }
          viz_CD(datariskCD[countries[j]].elements, countries[j], getCDid, voronoiCD, runColorCheck(colorObj,countries[j]));
        }
      createTT("cd");
        
      }

      // typographic adjustments on the labels
      function modifyLabels() {
        d3.selection.prototype.first = function() {
          return d3.select(this[0][0]);
        };
        d3.selection.prototype.last = function() {
          var last = this.size() - 1;
          return d3.select(this[0][last]);
        };

        var tickLabels = all_axis.selectAll('.y .tick text');

        tickLabels.first()
          .attr('transform','translate(0,-5)');
        tickLabels.last()
          .attr('transform','translate(0,7)');        
      } 

      function modifyLabelsCD() {
        d3.selection.prototype.first = function() {
          return d3.select(this[0][0]);
        };
        d3.selection.prototype.last = function() {
          var last = this.size() - 1;
          return d3.select(this[0][last]);
        };

        var tickLabels = all_axisCD.selectAll('.y .tick text');

        tickLabels.first()
          .attr('transform','translate(0,-5)');
        tickLabels.last()
          .attr('transform','translate(0,7)');        

      } 

      // visualize cases and deaths
      function viz_CD(data, country, cd, _voronoiCD, color_idx) {

        casesdeaths = cd;
        voronoiCD = _voronoiCD;
        // create new data w/ just cases and deaths
        var varNamesCD = d3.keys(data[0]).filter(function (keyCD) { return keyCD !== labelVar && keyCD != param1 && keyCD != param2 && keyCD != param3 && keyCD != param4 && keyCD != param5 && keyCD != risk1 && keyCD != risk2 && keyCD != risk3 && keyCD != risk4 && keyCD != risk5 && keyCD != risk6 && keyCD != risk7 && keyCD != risk8 && keyCD != risk9 && keyCD != risk10; });

        var seriesDataCD = varNamesCD.map(function (name) {
          return {
            name: name,
            values: data.map(function (d) {
              return {name: name, label: d[labelVar], value: +d[name], country: country};
            })
          };
        });

        // isolate series data and filter NA and missing values
        newdataC = {
            "name": null,
            "values": []
        }
        _seriesCases = seriesDataCD[0];

        for (var i in _seriesCases.values) {
            if (isNaN(_seriesCases.values[i].value) != true && _seriesCases.values[i].value != 0) {
              
                newdataC.name = _seriesCases.values[i].name;
                var _dataFilter = {
                    "label": _seriesCases.values[i].label,
                    "name": _seriesCases.values[i].name,
                    "country": _seriesCases.values[i].country,
                    "value": _seriesCases.values[i].value
                }
                newdataC.values.push(_dataFilter);
            }
        }

        newdataD = {
            "name": null,
            "values": []
        }
        _seriesDeaths = seriesDataCD[1];

        for (var i in _seriesDeaths.values) {
            if (isNaN(_seriesDeaths.values[i].value) != true && _seriesDeaths.values[i].value != 0) {
              
                newdataD.name = _seriesDeaths.values[i].name;
                var _dataFilter = {
                    "label": _seriesDeaths.values[i].label,
                    "name": _seriesDeaths.values[i].name,
                    "country": _seriesDeaths.values[i].country,
                    "value": _seriesDeaths.values[i].value
                }
                newdataD.values.push(_dataFilter);
            }
        }

        //console.log(seriesDataCD)

        var line = d3.svg.line()
          //.interpolate("monotone")
          .x(function (d) { return xpos(format_date(d.label));  })
          .y(function (d) { return yposCD(d.value); });

        // format voronoi data
        var voronoi_dataCD = function(input) {
          vData_input = input;
          uniqueData = d3.nest()
            .key(function(d) { return xpos(format_date(d.label)) + "," +yposCD(d.value); })
            .rollup(function(v) { return v[0]; })
            .entries(d3.merge(vData_input.map(function(d) { return d.values; })))
            .map(function(d) { return d.values });    
            vDataCD = uniqueData;        
        }

        // cases path
        if (casesdeaths=="Cases") {

          var seriesCD_c = d3.select("#cd-results-content #viz_CD")
            .datum(newdataC)
            .append("path")
            .attr("class", function (d) { return "lines lines-"+color_idx+" cd-"+d.name+" cd-"+country})
            .attr("id", function (d) { return "cd-"+d.name+"-"+country })
            .attr("d", function (d) { return line(d.values) });
          
          var series_text = d3.select("#cd-results-content #viz_CD")
            .datum(newdataC)
            .append("text")
            .attr("class", "cd-text-cases")
            .attr("x", 5)
            .attr("y", function (d) { 
              if (d.values[0].value>=80 && d.values[0].value <= 100)
              {
                return yposCD(d.values[0].value)+50 
              } else {
                return yposCD(d.values[0].value)-10
              }
            })
            .text("Cases: "+country) 

          v_cd.push(newdataC) 
          voronoi_dataCD(v_cd)        
        }
        //

        // deaths path        
        if (casesdeaths=="Deaths") {
        
          var seriesCD_d = d3.select("#cd-results-content #viz_CD")
            .datum(newdataD)
            .append("path")
            .attr("class", function (d) { return "lines lines-"+color_idx+" cd-"+d.name+" cd-"+country})
            .attr("id", function (d) { return "cd-"+d.name+"-"+country })
            .attr("d", function (d) { return line(d.values) })
  
          var series_text = d3.select("#cd-results-content #viz_CD")
            .datum(newdataD)
            .append("text")
            .attr("class", "cd-text-deaths")
            .attr("x", 5)
            .attr("y", function (d) { 
              if (d.values[0].value>=80 && d.values[0].value <= 100)
              {
                return yposCD(d.values[0].value)+50 
              } else {
                return yposCD(d.values[0].value)-10
              }
            })
            .text("Deaths: "+country)   

          v_cd.push(newdataD)
          voronoi_dataCD(v_cd)
        }

        // cases and deaths       
        if (casesdeaths=="Both") {

          var seriesCD_c = d3.select("#cd-results-content #viz_CD")
            .datum(newdataC)
            .append("path")
            .attr("class", function (d) { return "lines lines-"+color_idx+" cd-"+d.name+" cd-"+country})
            .attr("id", function (d) { return "cd-"+d.name+"-"+country })
            .attr("d", function (d) { return line(d.values) });

          var series_text = d3.select("#cd-results-content #viz_CD")
            .datum(newdataC)
            .append("text")
            .attr("class", "cd-text-cases")
            .attr("x", 5)
            .attr("y", function (d) { 
              if (d.values[0].value>=80 && d.values[0].value <= 100)
              {
                return yposCD(d.values[0].value)+50 
              } else {
                return yposCD(d.values[0].value)-10
              }
            })
            .text("Cases: "+country) 

          var seriesCD_d = d3.select("#cd-results-content #viz_CD")
            .datum(newdataD)
            .append("path")
            .attr("class", function (d) { return "lines lines-"+color_idx+" cd-"+d.name+" cd-"+country})
            .attr("id", function (d) { return "cd-"+d.name+"-"+country })
            .attr("d", function (d) { return line(d.values) })
  
          var series_text = d3.select("#cd-results-content #viz_CD")
            .datum(newdataD)
            .append("text")
            .attr("class", "cd-text-deaths")
            .attr("x", 5)
            .attr("y", function (d) { 
              if (d.values[0].value>=80 && d.values[0].value <= 100)
              {
                return yposCD(d.values[0].value)+50 
              } else {
                return yposCD(d.values[0].value)-10
              }
            })
            .text("Deaths: "+country)   

          v_cd.push(newdataC)
          v_cd.push(newdataD)
          voronoi_dataCD(v_cd)
        }
        
        // this may change, only want to apply to last instance of loop
        if (voronoiCD==true) {
          var vor = d3.select("#cd-results-content #viz_CD").append("g")
            .attr("id", "paths")
            .attr("class", "voronoi");

          var voronoi = d3.geom.voronoi()
            .x(function(d) { return xpos(format_date(d.label)); })
            .y(function(d) { return yposCD(d.value); })
            .clipExtent([[0, 0], [w - (p*2), hCD - p]]);
      
          var focus = d3.select("#cd-results-content #viz_CD").append("g")
            .attr("transform", "translate(-100,-100)")
            .attr("class", "focus");

          focus.append("circle")
            .attr("r", 5);

          focus.append("text")
            .attr("y", -10);

          vor.selectAll("path")
            .data(voronoi(vDataCD))
            .enter().append("path")
            .style("fill", "none")
            .style("stroke", "white")
            .style("stroke-opacity", 0)
            .attr("d", function (d) { return "M" + d.join("L") + "Z"; })
            .datum(function (d) { return d.point })
            .on("mouseover", mouseover)
            .on("mouseout", mouseout);            
        }

        function mouseover(d) {
          //console.log(d)
          d3.selectAll("#cd-results-content .lines-cd").style("opacity", "0.25")
          d3.selectAll("#cd-results-content #viz_CD .cd-"+d.country).classed("line--hover", true).moveToFront();
          tt("cd", d.name,d.country,d.label,d.value, xpos(format_date(d.label)), yposCD(d.value))
          focus.attr("transform", "translate(" + xpos(format_date(d.label)) + "," + yposCD(d.value) + ")");
        }

        function mouseout(d) {
          d3.selectAll("#cd-results-content .lines-cd").style("opacity", "1")
          d3.selectAll("#cd-results-content #viz_CD .cd-"+d.country).classed("line--hover", false);
          focus.attr("transform", "translate(-100,-100)");
        } 

        navEventsCD(casesdeaths, initNavCD);

      }

      $("#results-viz #cd-nav-left li").on("click", function(e) {
        e.preventDefault();
        $("#results-viz #cd-nav-left li").removeClass("cd-nav-left-active");
        $(this).toggleClass("cd-nav-left-active");
        getCDid = $(this).text();
        initNavCD = true;
        //console.log(getCDid);
        $("#results-viz .cd-results-content-risk").html("");
        createSVG_CD(cntrys_all, getCDid);
      })

      // this method will not work
      // need to call a function on click for the voronoi
      function navEventsCD(getCDid, initNavCD) {
        //console.log(initNavCD)
        var titleChange;
        if (getCDid=="Both") {
          titleChange = "Cases and deaths";
        } else {
          titleChange = getCDid;
        }
        $("#results-viz .cd-results-content-risk .cd-results-risks-title").remove();
        $("#results-viz .cd-results-content-risk").append("<div class='cd-results-risks-title'>"+titleChange+"</div></div>");
      }

      $("#index").on("click", function(e) {
        e.preventDefault();
        country_list.length = 0;
        $("#results-viz").hide();  
        $("#landing-page").fadeIn();      
      })    
  });
  </script>
</head>
<body>
<div id="landing-page">
    <div id="landing-header">
        <h1>Malaria Data Visualization Tool</h1>
        <h2>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam suscipit consequat scelerisque. Sed id facilisis est. Vestibulum sagittis diam quis arcu vehicula, ac luctus risus faucibus. Sed sed diam at nunc gravida scelerisque. Nam sed arcu at tortor sollicitudin imperdiet. Cras facilisis neque mi, quis lacinia nulla egestas in. Aenean vitae leo finibus, placerat nibh quis, consequat leo. Etiam augue dui, vestibulum nec viverra nec, molestie ut turpis. Mauris sit amet nibh.</h2>
    </div>

    <!-- placeholder, wait for 100-country list :: generate from spreadsheet -->
    <div id="loading_block">

      <div id="country-container">
        <select id="countries" name="countries">
            <option selected disabled>Choose up to 5 countries</option>
            <option value="All_Countries">All Countries</option>
            <option value="Africa-Algeria">Africa-Algeria</option>
            <option value="Africa-Angola">Africa-Angola</option>
            <option value="Africa-Benin">Africa-Benin</option>
            <option value="Africa-Botswana">Africa-Botswana</option>
            <option value="Africa-Burkina_Faso">Africa-Burkina_Faso</option>
            <option value="Africa-Burundi">Africa-Burundi</option>
            <option value="Africa-Cameroon">Africa-Cameroon</option>
            <option value="Africa-Cape_Verde">Africa-Cape_Verde</option>
            <option value="Africa-Central_African_Republic">Africa-Central_African_Republic</option>
            <option value="Africa-Chad">Africa-Chad</option>
            <option value="Africa-Comoro_Islands">Africa-Comoro_Islands</option>
            <option value="Africa-Democratic_Republic_of_the_Congo">Africa-Democratic_Republic_of_the_Congo</option>
            <option value="Africa-Djibouti">Africa-Djibouti</option>
            <option value="Africa-Egypt">Africa-Egypt</option>
            <option value="Africa-Equatorial_Guinea">Africa-Equatorial_Guinea</option>
            <option value="Africa-Eritrea">Africa-Eritrea</option>
            <option value="Africa-Ethiopia">Africa-Ethiopia</option>
            <option value="Africa-Gabon">Africa-Gabon</option>
            <option value="Africa-Gambia">Africa-Gambia</option>
            <option value="Africa-Ghana">Africa-Ghana</option>
            <option value="Africa-Guinea">Africa-Guinea</option>
            <option value="Africa-Guinea_Bissau">Africa-Guinea_Bissau</option>
            <option value="Africa-Ivory_Coast">Africa-Ivory_Coast</option>
            <option value="Africa-Kenya">Africa-Kenya</option>
            <option value="Africa-Lesotho">Africa-Lesotho</option>
            <option value="Africa-Liberia">Africa-Liberia</option>
            <option value="Africa-Libya">Africa-Libya</option>
            <option value="Africa-Madagascar">Africa-Madagascar</option>
            <option value="Africa-Malawi">Africa-Malawi</option>
            <option value="Africa-Mali">Africa-Mali</option>
            <option value="Africa-Mauritania">Africa-Mauritania</option>
            <option value="Africa-Mauritius">Africa-Mauritius</option>
            <option value="Africa-Morocco">Africa-Morocco</option>
            <option value="Africa-Mozambique">Africa-Mozambique</option>
            <option value="Africa-Namibia">Africa-Namibia</option>
            <option value="Africa-Niger">Africa-Niger</option>
            <option value="Africa-Nigeria">Africa-Nigeria</option>
            <option value="Africa-Republic_of_the_Congo">Africa-Republic_of_the_Congo</option>
            <option value="Africa-Reunion">Africa-Reunion</option>
            <option value="Africa-Rwanda">Africa-Rwanda</option>
            <option value="Africa-Sao_Tome_and_Principe">Africa-Sao_Tome_and_Principe</option>
            <option value="Africa-Senegal">Africa-Senegal</option>
            <option value="Africa-Seychelles">Africa-Seychelles</option>
            <option value="Africa-Sierra_Leone">Africa-Sierra_Leone</option>
            <option value="Africa-Somalia">Africa-Somalia</option>
            <option value="Africa-South_Africa">Africa-South_Africa</option>
            <option value="Africa-South_Sudan">Africa-South_Sudan</option>
            <option value="Africa-Sudan">Africa-Sudan</option>
            <option value="Africa-Swaziland">Africa-Swaziland</option>
            <option value="Africa-Tanzania">Africa-Tanzania</option>
            <option value="Africa-Togo">Africa-Togo</option>
            <option value="Africa-Tunisia">Africa-Tunisia</option>
            <option value="Africa-Uganda">Africa-Uganda</option>
            <option value="Africa-Zambia">Africa-Zambia</option>
            <option value="Africa-Zanzibar">Africa-Zanzibar</option>
            <option value="Africa-Zimbabwe">Africa-Zimbabwe</option>
            <option value="Asia-Afghanistan">Asia-Afghanistan</option>
            <option value="Asia-Bahrain">Asia-Bahrain</option>
            <option value="Asia-Bangladesh">Asia-Bangladesh</option>
            <option value="Asia-Bhutan">Asia-Bhutan</option>
            <option value="Asia-Brunei">Asia-Brunei</option>
            <option value="Asia-Cambodia">Asia-Cambodia</option>
            <option value="Asia-China">Asia-China</option>
            <option value="Asia-Cyprus">Asia-Cyprus</option>
            <option value="Asia-East_Timor">Asia-East_Timor</option>
            <option value="Asia-Hong_Kong">Asia-Hong_Kong</option>
            <option value="Asia-India">Asia-India</option>
            <option value="Asia-Indonesia">Asia-Indonesia</option>
            <option value="Asia-Iran">Asia-Iran</option>
            <option value="Asia-Iraq">Asia-Iraq</option>
            <option value="Asia-Israel">Asia-Israel</option>
            <option value="Asia-Japan">Asia-Japan</option>
            <option value="Asia-Jordan">Asia-Jordan</option>
            <option value="Asia-Kuwait">Asia-Kuwait</option>
            <option value="Asia-Laos">Asia-Laos</option>
            <option value="Asia-Lebanon">Asia-Lebanon</option>
            <option value="Asia-Macau">Asia-Macau</option>
            <option value="Asia-Malaysia">Asia-Malaysia</option>
            <option value="Asia-Maldives">Asia-Maldives</option>
            <option value="Asia-Mongolia">Asia-Mongolia</option>
            <option value="Asia-Myanmar">Asia-Myanmar</option>
            <option value="Asia-Nepal">Asia-Nepal</option>
            <option value="Asia-North_Korea">Asia-North_Korea</option>
            <option value="Asia-Oman">Asia-Oman</option>
            <option value="Asia-Pakistan">Asia-Pakistan</option>
            <option value="Asia-Philippines">Asia-Philippines</option>
            <option value="Asia-Qatar">Asia-Qatar</option>
            <option value="Asia-Ryukyu_Island">Asia-Ryukyu_Island</option>
            <option value="Asia-Saudi_Arabia">Asia-Saudi_Arabia</option>
            <option value="Asia-Singapore">Asia-Singapore</option>
            <option value="Asia-South_Korea">Asia-South_Korea</option>
            <option value="Asia-Sri_Lanka">Asia-Sri_Lanka</option>
            <option value="Asia-Syria">Asia-Syria</option>
            <option value="Asia-Taiwan">Asia-Taiwan</option>
            <option value="Asia-Thailand">Asia-Thailand</option>
            <option value="Asia-Turkey">Asia-Turkey</option>
            <option value="Asia-United_Arab_Emirates">Asia-United_Arab_Emirates</option>
            <option value="Asia-Vietnam">Asia-Vietnam</option>
            <option value="Asia-West_Bank_and_Gaza">Asia-West_Bank_and_Gaza</option>
            <option value="Asia-Yemen">Asia-Yemen</option>
            <option value="Europe-Albania">Europe-Albania</option>
            <option value="Europe-Armenia">Europe-Armenia</option>
            <option value="Europe-Austria">Europe-Austria</option>
            <option value="Europe-Azerbaijan">Europe-Azerbaijan</option>
            <option value="Europe-Belarus">Europe-Belarus</option>
            <option value="Europe-Belgium">Europe-Belgium</option>
            <option value="Europe-Bosnia">Europe-Bosnia</option>
            <option value="Europe-Bulgaria">Europe-Bulgaria</option>
            <option value="Europe-Croatia">Europe-Croatia</option>
            <option value="Europe-Cyprus">Europe-Cyprus</option>
            <option value="Europe-Czech_Republic">Europe-Czech_Republic</option>
            <option value="Europe-Czecho-slovakia">Europe-Czecho-slovakia</option>
            <option value="Europe-Denmark">Europe-Denmark</option>
            <option value="Europe-England">Europe-England</option>
            <option value="Europe-Estonia">Europe-Estonia</option>
            <option value="Europe-Finland">Europe-Finland</option>
            <option value="Europe-France">Europe-France</option>
            <option value="Europe-Georgia">Europe-Georgia</option>
            <option value="Europe-Germany">Europe-Germany</option>
            <option value="Europe-Greece">Europe-Greece</option>
            <option value="Europe-Hungary">Europe-Hungary</option>
            <option value="Europe-Ireland">Europe-Ireland</option>
            <option value="Europe-Isle_of_Man">Europe-Isle_of_Man</option>
            <option value="Europe-Italy">Europe-Italy</option>
            <option value="Europe-Kazakhstan">Europe-Kazakhstan</option>
            <option value="Europe-Kyrgyzstan">Europe-Kyrgyzstan</option>
            <option value="Europe-Latvia">Europe-Latvia</option>
            <option value="Europe-Lithuania">Europe-Lithuania</option>
            <option value="Europe-Macedonia">Europe-Macedonia</option>
            <option value="Europe-Malta">Europe-Malta</option>
            <option value="Europe-Moldova">Europe-Moldova</option>
            <option value="Europe-Netherlands">Europe-Netherlands</option>
            <option value="Europe-Northern_Ireland">Europe-Northern_Ireland</option>
            <option value="Europe-Norway">Europe-Norway</option>
            <option value="Europe-Poland">Europe-Poland</option>
            <option value="Europe-Portugal">Europe-Portugal</option>
            <option value="Europe-Romania">Europe-Romania</option>
            <option value="Europe-Russia">Europe-Russia</option>
            <option value="Europe-Scotland">Europe-Scotland</option>
            <option value="Europe-Serbia_Montenegro_Kosovo">Europe-Serbia_Montenegro_Kosovo</option>
            <option value="Europe-Slovenia">Europe-Slovenia</option>
            <option value="Europe-Spain">Europe-Spain</option>
            <option value="Europe-Sweden">Europe-Sweden</option>
            <option value="Europe-Switzerland">Europe-Switzerland</option>
            <option value="Europe-Tajikistan">Europe-Tajikistan</option>
            <option value="Europe-Turk-menistan">Europe-Turk-menistan</option>
            <option value="Europe-UK">Europe-UK</option>
            <option value="Europe-USSR">Europe-USSR</option>
            <option value="Europe-Ukraine">Europe-Ukraine</option>
            <option value="Europe-Uzbekistan">Europe-Uzbekistan</option>
            <option value="N-America-Canada">N-America-Canada</option>
            <option value="N-America-USA">N-America-USA</option>
            <option value="Oceania-Australia">Oceania-Australia</option>
            <option value="Oceania-Fiji_Islands">Oceania-Fiji_Islands</option>
            <option value="Oceania-Guam">Oceania-Guam</option>
            <option value="Oceania-New_Caledonia">Oceania-New_Caledonia</option>
            <option value="Oceania-New_Zealand">Oceania-New_Zealand</option>
            <option value="Oceania-Papua_New_Guinea">Oceania-Papua_New_Guinea</option>
            <option value="Oceania-Solomon_Islands">Oceania-Solomon_Islands</option>
            <option value="Oceania-Tonga">Oceania-Tonga</option>
            <option value="Oceania-Vanuatu">Oceania-Vanuatu</option>
            <option value="S-America-Bolivia">S-America-Bolivia</option>
            <option value="S-America-Brazil">S-America-Brazil</option>
            <option value="S-America-Chile">S-America-Chile</option>
            <option value="S-America-Colombia">S-America-Colombia</option>
            <option value="S-America-Costa_Rica">S-America-Costa_Rica</option>
            <option value="S-America-Cuba">S-America-Cuba</option>
            <option value="S-America-Dominica">S-America-Dominica</option>
            <option value="S-America-Dominican_Republic">S-America-Dominican_Republic</option>
            <option value="S-America-Ecuador">S-America-Ecuador</option>
            <option value="S-America-El_Salvador">S-America-El_Salvador</option>
            <option value="S-America-French_Guiana">S-America-French_Guiana</option>
            <option value="S-America-Grenada">S-America-Grenada</option>
            <option value="S-America-Guadeloupe">S-America-Guadeloupe</option>
            <option value="S-America-Guatemala">S-America-Guatemala</option>
            <option value="S-America-Guyana">S-America-Guyana</option>
            <option value="S-America-Haiti">S-America-Haiti</option>
            <option value="S-America-Honduras">S-America-Honduras</option>
            <option value="S-America-Jamaica">S-America-Jamaica</option>
            <option value="S-America-Leeward_Islands">S-America-Leeward_Islands</option>
            <option value="S-America-Martinique">S-America-Martinique</option>
            <option value="S-America-Mexico">S-America-Mexico</option>
            <option value="S-America-Nicaragua">S-America-Nicaragua</option>
            <option value="S-America-Panama">S-America-Panama</option>
            <option value="S-America-Paraguay">S-America-Paraguay</option>
            <option value="S-America-Peru">S-America-Peru</option>
            <option value="S-America-Puerto_Rico">S-America-Puerto_Rico</option>
            <option value="S-America-St_Chris_and_Nevis">S-America-St_Chris_and_Nevis</option>
            <option value="S-America-St_Lucia">S-America-St_Lucia</option>
            <option value="S-America-St_Vincent">S-America-St_Vincent</option>
            <option value="S-America-Suriname">S-America-Suriname</option>
            <option value="S-America-Trinidad_Tobago">S-America-Trinidad_Tobago</option>
            <option value="S-America-Uruguay">S-America-Uruguay</option>
            <option value="S-America-Venezuela">S-America-Venezuela</option>
            <option value="S-America-Virgin_Islands">S-America-Virgin_Islands</option>
            <option value="South_America-Antigua">South_America-Antigua</option>
            <option value="South_America-Argentina">South_America-Argentina</option>
            <option value="South_America-Bahama_Islands">South_America-Bahama_Islands</option>
            <option value="South_America-Belize">South_America-Belize</option>
            <option value="South_America-Bermuda">South_America-Bermuda</option>
        </select>
      </div>
      <!-- selected countries go here -->
      <div id="country-output-container">
        <div id="country-output"></div>
      </div>
      <div class="clear"></div>

      <!-- parameter block -->
      <div id="param-container">
        <div id="param-title-text">
            <p>Or use sliders to filter through all countries</p>
        </div>
        <div id="param-one" class="all-params">
            <div class="param-title">
                <p>Transmission Index</p>
            </div>
            <div class="sliders" id="slider-range-one"></div>
            <div class="value-ranges" id="value-range-one">
                <p>0 <span class="dash-class">&mdash;</span> 100</p>
            </div>
            <select name="number" id="param-year-one" class="param-year">
                <option value="yearsAll" value="yearsAll" selected="selected">All years</option>
                <option value="years1898to1910">1898 &mdash; 1910</option>
                <option value="years1911to1920">1911 &mdash; 1920</option>
                <option value="years1921to1930">1921 &mdash; 1930</option>
                <option value="years1931to1940">1931 &mdash; 1940</option>
                <option value="years1941to1950">1941 &mdash; 1950</option>
                <option value="years1951to1960">1951 &mdash; 1960</option>
                <option value="years1961to1970">1961 &mdash; 1970</option>
                <option value="years1971to1980">1971 &mdash; 1980</option>
                <option value="years1981to1990">1981 &mdash; 1990</option>
                <option value="years1991to2000">1991 &mdash; 2000</option>
                <option value="years2001to2005">2001 &mdash; 2005</option>
                <option value="years2006to2010">2006 &mdash; 2010</option>
                <option value="years2011to2015">2011 &mdash; 2015</option>
            </select>
            <div class="clear"></div>
        </div>

        <div id="param-two" class="all-params">
            <div class="param-title">
                <p>Climate Index</p>
            </div>
            <div class="sliders" id="slider-range-two"></div>
            <div class="value-ranges" id="value-range-two">
                <p>0 <span class="dash-class">&mdash;</span> 100</p>
            </div>
            <select name="number" id="param-year-two" class="param-year">
                <option value="yearsAll" selected="selected">All years</option>
                <option value="years1898to1910">1898 &mdash; 1910</option>
                <option value="years1911to1920">1911 &mdash; 1920</option>
                <option value="years1921to1930">1921 &mdash; 1930</option>
                <option value="years1931to1940">1931 &mdash; 1940</option>
                <option value="years1941to1950">1941 &mdash; 1950</option>
                <option value="years1951to1960">1951 &mdash; 1960</option>
                <option value="years1961to1970">1961 &mdash; 1970</option>
                <option value="years1971to1980">1971 &mdash; 1980</option>
                <option value="years1981to1990">1981 &mdash; 1990</option>
                <option value="years1991to2000">1991 &mdash; 2000</option>
                <option value="years2001to2005">2001 &mdash; 2005</option>
                <option value="years2006to2010">2006 &mdash; 2010</option>
                <option value="years2011to2015">2011 &mdash; 2015</option>
            </select>
            <div class="clear"></div>
        </div>

        <div id="param-three" class="all-params">
            <div class="param-title">
                <p>Vector Behavior Index</p>
            </div>
            <div class="sliders" id="slider-range-three"></div>
            <div class="value-ranges" id="value-range-three">
                <p>0 <span class="dash-class">&mdash;</span> 100</p>
            </div>
            <select name="number" id="param-year-three" class="param-year">
                <option value="yearsAll" selected="selected">All years</option>
                <option value="years1898to1910">1898 &mdash; 1910</option>
                <option value="years1911to1920">1911 &mdash; 1920</option>
                <option value="years1921to1930">1921 &mdash; 1930</option>
                <option value="years1931to1940">1931 &mdash; 1940</option>
                <option value="years1941to1950">1941 &mdash; 1950</option>
                <option value="years1951to1960">1951 &mdash; 1960</option>
                <option value="years1961to1970">1961 &mdash; 1970</option>
                <option value="years1971to1980">1971 &mdash; 1980</option>
                <option value="years1981to1990">1981 &mdash; 1990</option>
                <option value="years1991to2000">1991 &mdash; 2000</option>
                <option value="years2001to2005">2001 &mdash; 2005</option>
                <option value="years2006to2010">2006 &mdash; 2010</option>
                <option value="years2011to2015">2011 &mdash; 2015</option>
            </select>
            <div class="clear"></div>
        </div>

        <div id="param-four" class="all-params">
            <div class="param-title">
                <p>Development Index</p>
            </div>
            <div class="sliders" id="slider-range-four"></div>
            <div class="value-ranges" id="value-range-four">
                <p>0 <span class="dash-class">&mdash;</span> 100</p>
            </div>
            <select name="number" id="param-year-four" class="param-year">
                <option value="yearsAll" selected="selected">All years</option>
                <option value="years1898to1910">1898 &mdash; 1910</option>
                <option value="years1911to1920">1911 &mdash; 1920</option>
                <option value="years1921to1930">1921 &mdash; 1930</option>
                <option value="years1931to1940">1931 &mdash; 1940</option>
                <option value="years1941to1950">1941 &mdash; 1950</option>
                <option value="years1951to1960">1951 &mdash; 1960</option>
                <option value="years1961to1970">1961 &mdash; 1970</option>
                <option value="years1971to1980">1971 &mdash; 1980</option>
                <option value="years1981to1990">1981 &mdash; 1990</option>
                <option value="years1991to2000">1991 &mdash; 2000</option>
                <option value="years2001to2005">2001 &mdash; 2005</option>
                <option value="years2006to2010">2006 &mdash; 2010</option>
                <option value="years2011to2015">2011 &mdash; 2015</option>
            </select>
            <div class="clear"></div>
        </div>

        <div id="param-five" class="all-params">
            <div class="param-title">
                <p>Intervention Index</p>
            </div>
            <div class="sliders" id="slider-range-five"></div>
            <div class="value-ranges" id="value-range-five">
                <p>0 <span class="dash-class">&mdash;</span> 100</p>
            </div>
            <select name="number" id="param-year-five" class="param-year">
                <option value="yearsAll" selected="selected">All years</option>
                <option value="years1898to1910">1898 &mdash; 1910</option>
                <option value="years1911to1920">1911 &mdash; 1920</option>
                <option value="years1921to1930">1921 &mdash; 1930</option>
                <option value="years1931to1940">1931 &mdash; 1940</option>
                <option value="years1941to1950">1941 &mdash; 1950</option>
                <option value="years1951to1960">1951 &mdash; 1960</option>
                <option value="years1961to1970">1961 &mdash; 1970</option>
                <option value="years1971to1980">1971 &mdash; 1980</option>
                <option value="years1981to1990">1981 &mdash; 1990</option>
                <option value="years1991to2000">1991 &mdash; 2000</option>
                <option value="years2001to2005">2001 &mdash; 2005</option>
                <option value="years2006to2010">2006 &mdash; 2010</option>
                <option value="years2011to2015">2011 &mdash; 2015</option>
            </select>
            <div class="clear"></div>
        </div>
      </div>
      <div id="no_results">
      <p>No Results &ndash; Try Again</p>
      </div>
      <div id="landing-submit">
          <p>View Results</p>
      </div>
      <div id="landing-results-output-test"></div>

    </div>
    <div id="loading_msg">
      <p>Loading data...<span class="data_progress">0</span>/14</p>
    </div>
      
    <div id="landing-footer">
        <p>By Derek Willis
            <br/>& Explain Corp.</p>
    </div>
</div>

<div id="results-viz">
    <div class="results-header">
        <h2><a href="/">Malaria Data Visualization Tool</a></h2>
        <div class="results-header-countries">
            <h3 class="nav-active-countries">Loading...</h3>
        </div>
    </div>
    <div id="results-nav-risks">
        <ul id="nav-risks">
            <li class="risks-active" id="risks-population_RISK_FACTOR">Total Population</li>
            <li id="risks-GDP_per_capita_RISK_FACTOR">GDP per capita*</li>
            <li id="risks-IRS_RISK_FACTOR">Indoor residual spraying</li>
            <li id="risks-ALL_nets_RISK_FACTOR">Insecticidal nets</li>
            <li id="risks-insecticide_resistance_RISK_FACTOR">Insecticide resistance</li>
            <li id="risks-pop_at_risk_RISK_FACTOR">Population at risk</li>
            <li id="risks-funding_RISK_FACTOR">Funding*</li>
            <li id="risks-ALL_larval_control_RISK_FACTOR">Larval control</li>
            <li id="risks-drugs_RISK_FACTOR">Antimalarial drugs</li>
            <li id="risks-drug_resistance_RISK_FACTOR">Drug resistance</li>
        </ul>
        <div class="clear"></div>
    </div>
    <div id="results-nav-left">
        <p>Select up to five countries</p>
        <ul id="nav-left">
            <li>Loading...</li>
        </ul>
        <div class="clear"></div>
    </div>
    <div id="results-content">
        <p style="font-size:150px;color:#ddd;letter-spacing:-10px;position:relative;margin-left:20px">Loading...</p>
        <div class="results-content-risk"></div>

    </div>
    <div class="clear"></div>

    <div id="cases-deaths">
        <div id="cd-nav-left">
            <p>Cases and deaths</p>
            <ul id="cd-nav-left">
                <li class="cd-nav-left-active">Cases</li>
                <li>Deaths</li>
                <li>Both</li>
            </ul>
            <div class="clear"></div>
        </div>
        <div id="cd-results-content">
            <div class="cd-results-content-risk"></div>
        </div>
        <div class="clear"></div>
    </div>
    <div id="index">
      <p><a href="#">Back to Search Index</a></p>
    </div>
    <div id="footer">
      <h4><span class="pdflink">LINK TO PDF: TITLE HERE?</span> &mdash; <span class="footer-method">Methodology</span> &mdash; <span class="footer-explain">Made by Explain Corp.</span></h4>
    </div>
</div>
</body>
</html>